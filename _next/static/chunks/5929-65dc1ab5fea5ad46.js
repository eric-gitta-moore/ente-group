"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5929],{73216:function(t,e,n){var r=n(71600);e.Z=void 0;var i=r(n(84198)),a=n(52322);e.Z=(0,i.default)((0,a.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},16331:function(t,e,n){var r=n(71600);e.Z=void 0;var i=r(n(84198)),a=n(52322);e.Z=(0,i.default)((0,a.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff")},36673:function(t,e,n){n.d(e,{Z:function(){return P}});var r,i=n(31461),a=n(7896),o=n(2784),c=n(40489),l=n(69075),s=n(36082),u=n(42541),d=n(19256),f=n(86685),h=n(31572),p=n(69222),Z=n(15672);function v(t){return(0,Z.ZP)("MuiInputAdornment",t)}let g=(0,p.Z)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var m=n(34183),w=n(52322);let E=["children","className","component","disablePointerEvents","disableTypography","position","variant"],S=t=>{let{classes:e,disablePointerEvents:n,hiddenLabel:r,position:i,size:a,variant:o}=t,c={root:["root",n&&"disablePointerEvents",i&&"position".concat((0,s.Z)(i)),o,r&&"hiddenLabel",a&&"size".concat((0,s.Z)(a))]};return(0,l.Z)(c,v,e)},y=(0,h.ZP)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(t,e)=>{let{ownerState:n}=t;return[e.root,e["position".concat((0,s.Z)(n.position))],!0===n.disablePointerEvents&&e.disablePointerEvents,e[n.variant]]}})(t=>{let{theme:e,ownerState:n}=t;return(0,a.Z)({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active},"filled"===n.variant&&{["&.".concat(g.positionStart,"&:not(.").concat(g.hiddenLabel,")")]:{marginTop:16}},"start"===n.position&&{marginRight:8},"end"===n.position&&{marginLeft:8},!0===n.disablePointerEvents&&{pointerEvents:"none"})});var P=o.forwardRef(function(t,e){let n=(0,m.i)({props:t,name:"MuiInputAdornment"}),{children:l,className:s,component:h="div",disablePointerEvents:p=!1,disableTypography:Z=!1,position:v,variant:g}=n,P=(0,i.Z)(n,E),x=(0,f.Z)()||{},b=g;g&&x.variant,x&&!b&&(b=x.variant);let C=(0,a.Z)({},n,{hiddenLabel:x.hiddenLabel,size:x.size,disablePointerEvents:p,position:v,variant:b}),R=S(C);return(0,w.jsx)(d.Z.Provider,{value:null,children:(0,w.jsx)(y,(0,a.Z)({as:h,ownerState:C,className:(0,c.Z)(R.root,s),ref:e},P,{children:"string"!=typeof l||Z?(0,w.jsxs)(o.Fragment,{children:["start"===v?r||(r=(0,w.jsx)("span",{className:"notranslate",children:"â€‹"})):null,l]}):(0,w.jsx)(u.Z,{color:"text.secondary",children:l})}))})})},34360:function(t,e,n){var r,i;n.d(e,{q:function(){return r}}),(i=r||(r={})).ROOT="/",i.CHANGE_EMAIL="/change-email",i.CHANGE_PASSWORD="/change-password",i.CREDENTIALS="/credentials",i.GENERATE="/generate",i.LOGIN="/login",i.RECOVER="/recover",i.SIGNUP="/signup",i.TWO_FACTOR_SETUP="/two-factor/setup",i.TWO_FACTOR_VERIFY="/two-factor/verify",i.TWO_FACTOR_RECOVER="/two-factor/recover",i.VERIFY="/verify",i.SHARED_ALBUMS="/shared-albums"},19764:function(t,e,n){n.d(e,{Bs:function(){return h},a4:function(){return p},pL:function(){return Z},u1:function(){return v}});var r=n(22969),i=n(10934),a=n(38045),o=n(29650),c=n(50232),l=n(6364),s=n(50193),u=n(39596),d=n(79644).Buffer;let f=c.SRP.params["4096"],h=async t=>{let{srpSalt:e,srpUserID:n,srpVerifier:r,loginSubKey:a}=t;try{let t=await v(e,n,a),c=(0,u.HC)(t.computeA());i.ZP.debug(()=>"srp a: ".concat(c));let l=(0,o.LP)(),{setupID:d,srpB:f}=await (0,s.zx)(l,{srpA:c,srpUserID:n,srpSalt:e,srpVerifier:r});t.setB((0,u.GS)(f));let h=(0,u.HC)(t.computeM1()),{srpM2:p}=await (0,s.XD)(l,{srpM1:h,setupID:d});t.checkM2((0,u.GS)(p))}catch(t){throw i.ZP.error("Failed to configure SRP",t),t}},p=async t=>{let e=await (0,r.Lb)(),n=await e.generateSaltToDeriveKey(),a=(0,l.Z)(),o=c.SRP.computeVerifier(f,(0,u.GS)(n),d.from(a),(0,u.GS)(t)),s={srpUserID:a,srpSalt:n,srpVerifier:(0,u.HC)(o),loginSubKey:t};return i.ZP.debug(()=>"SRP setup attributes generated: ".concat(JSON.stringify(s))),s},Z=async(t,e)=>{try{let n=await (0,a.uA)(e),r=await v(t.srpSalt,t.srpUserID,n),o=r.computeA(),{srpB:c,sessionID:l}=await (0,s.IG)(t.srpUserID,(0,u.HC)(o));r.setB((0,u.GS)(c));let d=r.computeM1();i.ZP.debug(()=>"srp m1: ".concat((0,u.HC)(d)));let{srpM2:f,...h}=await (0,s.gd)(l,t.srpUserID,(0,u.HC)(d));return i.ZP.debug(()=>"srp verify session successful,srpM2: ".concat(f)),r.checkM2((0,u.GS)(f)),i.ZP.debug(()=>"srp server verify successful"),h}catch(t){throw i.ZP.error("srp verify failed",t),t}},v=async(t,e,n)=>new Promise((r,i)=>{c.SRP.genKey(function(a,o){try{if(a&&i(a),!o)throw Error("secret1 gen failed");let l=new c.SrpClient(f,(0,u.GS)(t),d.from(e),(0,u.GS)(n),o,!1);r(l)}catch(t){i(t)}})})},39596:function(t,e,n){n.d(e,{DZ:function(){return s},GS:function(){return c},HC:function(){return o},rp:function(){return l}});var r=n(16152),i=n.n(r),a=n(79644).Buffer;let o=t=>t.toString("base64"),c=t=>a.from(t,"base64");function l(t){if(!t)return"weak";let e=i()(t);return e.score<2?"weak":e.score<3?"moderate":"strong"}let s=t=>"weak"==l(t)},22063:function(t,e,n){var r=n(52903),i=n(91430),a=n(37862);n(2784),e.Z=t=>{let{sx:e,style:n,...o}=t;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(a.Z,{}),(0,r.tZ)(i.wx,{style:{flexDirection:"row",...n},sx:{mt:3,...e},...o,children:o.children})]})}},60108:function(t,e,n){var r=n(31572),i=n(67295);let a=(0,r.ZP)(i.Z)(t=>{let{theme:e}=t;return{padding:e.spacing(4,2),maxWidth:"360px",width:"100%",textAlign:"left"}});e.Z=a},63141:function(t,e,n){n.d(e,{AL:function(){return _},En:function(){return b},TJ:function(){return A},pg:function(){return M}});var r=n(73235),i=n(52903),a=n(16645),o=n(10934),c=n(68351),l=n(30394),s=n(42541),u=n(31572),d=n(96566),f=n(7706),h=n(24991),p=n(5632),Z=n(2784),v=n(91430);let g=()=>({title:(0,h.t)("error"),close:{variant:"critical"},content:(0,h.t)("UNKNOWN_ERROR")});var m=n(60108),w=n(22063),E=n(83446);function S(){let t=(0,r._)(["\n    margin-block-end: 4rem;\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n"]);return S=function(){return t},t}function y(){let t=(0,r._)(["\n    display: flex;\n    flex-direction: column;\n\n    padding-block: 1rem;\n    gap: 4rem;\n"]);return y=function(){return t},t}function P(){let t=(0,r._)(["\n    text-align: center;\n    /* Size of the CircularProgress (+ some margin) so that there is no layout\n       shift when it is shown */\n    min-height: 2em;\n"]);return P=function(){return t},t}function x(){let t=(0,r._)(["\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n"]);return x=function(){return t},t}let b=t=>{let{children:e}=t;return(0,i.BX)(R,{children:[(0,i.tZ)(s.Z,{variant:"h2",children:(0,h.t)("password")}),(0,i.tZ)(s.Z,{color:"text.faint",children:e})]})},C=t=>{let{children:e}=t;return(0,i.BX)(R,{children:[(0,i.tZ)(s.Z,{variant:"h3",children:"Passkey"}),(0,i.tZ)(s.Z,{color:"text.faint",children:e})]})},R=(0,u.ZP)("div")(S()),_=t=>{let{children:e}=t,[n,r]=(0,Z.useState)();return(0,Z.useEffect)(()=>void(0,c.yv)().then(r),[]),(0,i.tZ)(w.Z,{children:(0,i.BX)(d.Z,{gap:"16px",width:"100%",textAlign:"start",children:[e,n&&(0,i.tZ)(s.Z,{variant:"small",color:"text.faint",children:n})]})})},A=t=>{let{passkeySessionID:e,email:n,onRetry:r,logout:c,setDialogBoxAttributesV2:u}=t,[w,S]=(0,Z.useState)("waiting"),y=(0,p.useRouter)(),P=async()=>{S("checking");try{let t=await (0,a.px)(e);t?y.push(await (0,a.lQ)(t)):S("pending")}catch(t){o.ZP.error("Passkey verification status check failed",t),u(t instanceof Error&&t.message==a.MF?M(c):g()),S("waiting")}};return(0,i.tZ)(v.wx,{children:(0,i.BX)(m.Z,{style:{minWidth:"320px"},children:[(0,i.tZ)(C,{children:null!=n?n:""}),(0,i.BX)(k,{children:[(0,i.tZ)(I,{children:"checking"==w?(0,i.tZ)(s.Z,{children:(0,i.tZ)(f.Z,{color:"accent",size:"1.5em"})}):(0,i.tZ)(s.Z,{color:"text.muted",children:"waiting"==w?(0,h.t)("waiting_for_verification"):(0,h.t)("verification_still_pending")})}),(0,i.BX)(O,{children:[(0,i.tZ)(l.Z,{onClick:()=>{S("waiting"),r()},fullWidth:!0,color:"secondary",type:"button",children:(0,h.t)("try_again")}),(0,i.tZ)(l.Z,{onClick:P,fullWidth:!0,color:"accent",type:"button",children:(0,h.t)("check_status")})]})]}),(0,i.tZ)(_,{children:(0,i.BX)(d.Z,{direction:"row",justifyContent:"space-between",children:[(0,i.tZ)(E.Z,{onClick:()=>{y.push("/passkeys/recover")},children:(0,h.t)("RECOVER_ACCOUNT")}),(0,i.tZ)(E.Z,{onClick:c,children:(0,h.t)("CHANGE_EMAIL")})]})})]})})},k=(0,u.ZP)("div")(y()),I=(0,u.ZP)("div")(P()),O=(0,u.ZP)("div")(x()),M=t=>({title:(0,h.t)("SESSION_EXPIRED"),content:(0,h.t)("SESSION_EXPIRED_MESSAGE"),nonClosable:!0,proceed:{text:(0,h.t)("login"),action:t,variant:"accent"}})}}]);