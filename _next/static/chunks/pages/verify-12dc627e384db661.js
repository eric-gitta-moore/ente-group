(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{58362:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return n(625)}])},625:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return B}});var i=n(52903),a=n(10934),l=n(8033),r=n(91430),o=n(98996),E=n(60108),c=n(63462),s=n(83446),u=n(63141),d=n(50006),T=n(27949),_=n(27588),R=n(25683),Z=n(29650),S=n(50267),p=n(58488),h=n(42541),I=n(96566),f=n(80613),A=n(24991),w=n(5632),N=n(2784),C=n(98614),P=n(50193),y=n(30433),O=n(34360),b=n(16645),m=n(12595),Y=n(19764),v=t=>{let{appContext:e}=t,{logout:n,showNavBar:P,setDialogBoxAttributesV2:v}=e,[U,B]=(0,N.useState)(""),[x,D]=(0,N.useState)(0),[L,G]=(0,N.useState)(),K=(0,w.useRouter)();(0,N.useEffect)(()=>{(async()=>{let t=(0,R.Yu)(R.Pd.USER),e=await k(t);e?K.push(e):B(t.email)})(),P(!0)},[]);let F=async(t,e)=>{try{let e=(0,Z.vE)(),{keyAttributes:n,encryptedToken:i,token:a,id:r,twoFactorSessionID:o,passkeySessionID:E}=(await (0,y._O)(U,t,e)).data;if(E){let t=(0,R.Yu)(R.Pd.USER);await (0,R.CA)({...t,passkeySessionID:E,isTwoFactorEnabled:!0,isTwoFactorPasskeysEnabled:!0}),(0,Z.Qj)(!0);let e=(0,b.Yn)(E);G({passkeySessionID:E,url:e}),(0,b.$G)({passkeySessionID:E,url:e})}else if(o)await (0,R.CA)({email:U,twoFactorSessionID:o,isTwoFactorEnabled:!0}),(0,Z.Qj)(!0),K.push(O.q.TWO_FACTOR_VERIFY);else{if(await (0,R.CA)({email:U,token:a,encryptedToken:i,id:r,isTwoFactorEnabled:!1}),n)(0,R.a_)(R.Pd.KEY_ATTRIBUTES,n),(0,R.a_)(R.Pd.ORIGINAL_KEY_ATTRIBUTES,n);else if((0,R.Yu)(R.Pd.ORIGINAL_KEY_ATTRIBUTES)&&await (0,y.p6)((0,l.zx)(a),(0,R.Yu)(R.Pd.ORIGINAL_KEY_ATTRIBUTES)),(0,R.Yu)(R.Pd.SRP_SETUP_ATTRIBUTES)){let t=(0,R.Yu)(R.Pd.SRP_SETUP_ATTRIBUTES);await (0,Y.Bs)(t)}_.Z.clear(),(0,Z.Qj)(!0);let t=(0,m.pr)();(null==n?void 0:n.encryptedKey)?((0,S.z5)(),K.push(null!=t?t:O.q.CREDENTIALS)):K.push(null!=t?t:O.q.GENERATE)}}catch(t){t instanceof T.MS?(null==t?void 0:t.httpStatusCode)===f.WE.Unauthorized?e((0,A.t)("INVALID_CODE")):(null==t?void 0:t.httpStatusCode)===f.WE.Gone&&e((0,A.t)("EXPIRED_CODE")):(a.ZP.error("OTT verification failed",t),e("".concat((0,A.t)("UNKNOWN_ERROR")," ").concat(JSON.stringify(t))))}},q=async()=>{D(1),await (0,y.Tb)(U),D(2),setTimeout(()=>D(0),3e3)};return U?L?globalThis.electron?(0,i.tZ)(u.TJ,{email:U,passkeySessionID:null==L?void 0:L.passkeySessionID,onRetry:()=>(0,b.$G)(L),logout:n,setDialogBoxAttributesV2:v}):(0,i.tZ)(r.wx,{children:(0,i.tZ)(o.Z,{})}):(0,i.tZ)(r.wx,{children:(0,i.BX)(E.Z,{children:[(0,i.tZ)(c.Z,{sx:{mb:14,wordBreak:"break-word"},children:(0,i.tZ)(C.cC,{i18nKey:"EMAIL_SENT",components:{a:(0,i.tZ)(p.Z,{color:"text.muted",component:"span"})},values:{email:U}})}),(0,i.tZ)(h.Z,{color:"text.muted",mb:2,variant:"small",children:(0,A.t)("CHECK_INBOX")}),(0,i.tZ)(d.Z,{fieldType:"text",autoComplete:"one-time-code",placeholder:(0,A.t)("ENTER_OTT"),buttonText:(0,A.t)("VERIFY"),callback:F}),(0,i.tZ)(u.AL,{children:(0,i.BX)(I.Z,{direction:"row",justifyContent:"space-between",children:[0===x&&(0,i.tZ)(s.Z,{onClick:q,children:(0,A.t)("RESEND_MAIL")}),1===x&&(0,i.tZ)("span",{children:(0,A.t)("SENDING")}),2===x&&(0,i.tZ)("span",{children:(0,A.t)("SENT")}),(0,i.tZ)(s.Z,{onClick:n,children:(0,A.t)("CHANGE_EMAIL")})]})})]})}):(0,i.tZ)(r.wx,{children:(0,i.tZ)(o.Z,{})})};let k=async t=>{let e=null==t?void 0:t.email;if(!e)return"/";let n=(0,R.Yu)(R.Pd.KEY_ATTRIBUTES);if((null==n?void 0:n.encryptedKey)&&(t.token||t.encryptedToken))return O.q.CREDENTIALS;if((0,m.Gt)()==O.q.RECOVER)return;let i=(0,R.Yu)(R.Pd.SRP_ATTRIBUTES);if(i&&!i.isEmailMFAEnabled){let t=await (0,P.O3)(e);if(t&&!t.isEmailMFAEnabled)return O.q.CREDENTIALS}};var U=n(55005),B=()=>(0,i.tZ)(v,{appContext:(0,U.useAppContext)()})},63462:function(t,e,n){"use strict";var i=n(52903),a=n(42541);n(2784),e.Z=t=>{let{sx:e,...n}=t;return(0,i.tZ)(a.Z,{variant:"h2",sx:{mb:8,...e},...n,children:n.children})}}},function(t){t.O(0,[1981,1708,4373,3432,3692,6702,5929,2888,9774,179],function(){return t(t.s=58362)}),_N_E=t.O()}]);