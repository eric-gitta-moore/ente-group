(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{87314:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(58578)}])},58578:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ei}});var i=n(73235),r=n(52903),a=n(18944),l=n(1885),o=n(10934),d=n(68351),c=n(52535),s=n(58034),u=n(90106),h=n(97490),p=n(22711),Z=n(54002),m=n(38898),f=n(53793),g=n(36673),x=n(72595),_=n(53091),E=n(17699),b=n(31708),w=n(24991),R=n(2784),y=n(30195),S=n(81174),C=n(40651);let v=e=>{let{open:t,onClose:n}=e,i=(0,c.I)();return(0,r.tZ)(p.Z,{open:t,fullScreen:i,onClose:(e,t)=>{"backdropClick"!=t&&n()},TransitionComponent:C.s,maxWidth:"xs",fullWidth:!0,children:(0,r.tZ)(T,{onClose:n})})},T=e=>{let[t,n]=(0,R.useState)();return((0,R.useEffect)(()=>void(0,u.Ke)("apiOrigin").then(e=>n(null!=e?e:"")),[]),void 0===t)?(0,r.tZ)(r.HY,{}):(0,r.tZ)(A,{initialAPIOrigin:t,...e})},A=e=>{let{initialAPIOrigin:t,onClose:n}=e,i=(0,b.TA)({initialValues:{apiOrigin:t},validate:e=>{let{apiOrigin:t}=e;try{t&&new URL(t)}catch(e){return{apiOrigin:"Invalid endpoint"}}return{}},onSubmit:async(e,t)=>{let{setSubmitting:i,setErrors:r}=t;try{await O(e.apiOrigin)}catch(e){r({apiOrigin:e instanceof Error?e.message:String(e)});return}i(!1),n()}}),a=i.submitCount>0&&i.touched.apiOrigin&&!!i.errors.apiOrigin;return(0,r.BX)("form",{onSubmit:i.handleSubmit,children:[(0,r.tZ)(Z.Z,{children:(0,w.t)("developer_settings")}),(0,r.tZ)(m.Z,{sx:{"&&":{paddingBlock:"8px"}},children:(0,r.tZ)(f.Z,{fullWidth:!0,autoFocus:!0,id:"apiOrigin",name:"apiOrigin",label:(0,w.t)("server_endpoint"),placeholder:"http://localhost:8080",value:i.values.apiOrigin,onChange:i.handleChange,onBlur:i.handleBlur,error:a,helperText:a?i.errors.apiOrigin:" ",InputProps:{endAdornment:(0,r.tZ)(g.Z,{position:"end",children:(0,r.tZ)(x.Z,{href:"https://help.ente.io/self-hosting/guides/custom-server/",target:"_blank",rel:"noopener",children:(0,r.tZ)(_.Z,{"aria-label":(0,w.t)("more_information"),color:"secondary",edge:"end",children:(0,r.tZ)(h.Z,{})})})})}})}),(0,r.BX)(E.Z,{children:[(0,r.tZ)(S.U,{type:"submit",color:"accent",fullWidth:!0,disabled:i.isSubmitting,children:(0,w.t)("save")}),(0,r.tZ)(S.U,{onClick:n,color:"secondary",fullWidth:!0,children:(0,w.t)("cancel")})]})]})},O=async e=>{if(!e){await (0,u.cQ)("apiOrigin");return}let t=await fetch("".concat(e,"/ping"));(0,s.H9)(t);try{I.parse(await t.json())}catch(e){throw o.ZP.error("Invalid response",e),Error("Invalid response")}await (0,u.fu)("apiOrigin",e)},I=y.z.object({message:y.z.enum(["pong"])});var P=n(36659),N=n(98996),B=n(8620),k=n(38045),L=n(27588),U=n(25683),W=n(29650),X=n(50267),M=n(10222),H=n(31572),V=n(58488),D=n(42541),Y=n(5632),F=n(98402);n(50281);var K=n(98614),G=n(55005);function j(){let e=(0,i._)(["\n    display: flex;\n    flex: 1;\n    align-items: center;\n    justify-content: center;\n    background-color: #000;\n\n    @media (max-width: 1024px) {\n        flex-direction: column;\n    }\n"]);return j=function(){return e},e}function Q(){let e=(0,i._)(["\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n\n    @media (max-width: 1024px) {\n        flex-grow: 0;\n    }\n"]);return Q=function(){return e},e}function q(){let e=(0,i._)(["\n    margin-block-end: 64px;\n"]);return q=function(){return e},e}function z(){let e=(0,i._)(["\n    display: none;\n\n    @media (max-width: 1024px) {\n        max-width: 375px;\n        width: 100%;\n        padding: 12px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n    }\n"]);return z=function(){return e},e}function J(){let e=(0,i._)(["\n    flex: 1;\n    height: 100%;\n    padding: 10px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: #242424;\n\n    @media (max-width: 1024px) {\n        display: none;\n    }\n"]);return J=function(){return e},e}function $(){let e=(0,i._)(["\n    display: flex;\n    flex-direction: column;\n    min-width: 320px;\n"]);return $=function(){return e},e}function ee(){let e=(0,i._)(["\n    height: 250px;\n    object-fit: contain;\n\n    @media (max-width: 400px) {\n        height: 180px;\n    }\n"]);return ee=function(){return e},e}function et(){let e=(0,i._)(["\n    margin-block-start: 2px;\n    margin-block-end: 24px;\n\n    button {\n        margin-inline-end: 14px;\n        width: 10px;\n        height: 10px;\n        border-radius: 50%;\n        padding: 0;\n        border: 0;\n        background-color: #fff;\n        opacity: 0.5;\n        transition: opacity 0.6s ease;\n    }\n\n    button.carousel__dot--selected {\n        background-color: #51cd7c;\n        opacity: 1;\n    }\n"]);return et=function(){return e},e}function en(){let e=(0,i._)(["\n    display: flex;\n    flex-direction: column;\n"]);return en=function(){return e},e}function ei(){let{showNavBar:e,setDialogMessage:t}=(0,G.useAppContext)(),[n,i]=(0,R.useState)(!0),[c,s]=(0,R.useState)(!0),[u,h]=(0,R.useState)(),p=(0,Y.useRouter)(),Z=(0,R.useCallback)(()=>void(0,d.yv)().then(h),[]);(0,R.useEffect)(()=>{Z(),e(!1);let t=new URL(window.location.href),n=new URL((0,d.BV)());t.pathname=p.pathname,t.host===n.host&&t.pathname!==B.W.SHARED_ALBUMS?m(t):f()},[Z]);let m=async e=>{let t=e.hash.lastIndexOf("&"),n=e.hash.slice(1,-1!==t?t:void 0);await p.replace({pathname:B.W.SHARED_ALBUMS,search:e.search,hash:n}),await g()},f=async()=>{let e=(0,U.Yu)(U.Pd.USER),t=(0,X.km)(X.Qm.ENCRYPTION_KEY),n=globalThis.electron;if(!t&&n){try{t=await n.masterKeyB64()}catch(e){o.ZP.error("Failed to read master key from safe storage",e)}t&&await (0,k.CP)(X.Qm.ENCRYPTION_KEY,t,!0)}let r=(0,W.LP)();t&&r?await p.push(B.W.GALLERY):(null==e?void 0:e.email)&&await p.push(B.W.VERIFY),await g(),i(!1)},g=async()=>{try{await L.Z.ready()}catch(e){o.ZP.error("usage in incognito mode tried",e),t({title:(0,w.t)("LOCAL_STORAGE_NOT_ACCESSIBLE"),nonClosable:!0,content:(0,w.t)("LOCAL_STORAGE_NOT_ACCESSIBLE_MESSAGE")})}finally{i(!1)}};return(0,r.tZ)(er,{onMaybeChangeHost:Z,children:n?(0,r.tZ)(N.Z,{}):(0,r.BX)(r.HY,{children:[(0,r.BX)(eo,{children:[(0,r.tZ)(ed,{children:(0,r.tZ)(P.W,{height:24})}),(0,r.tZ)(ep,{})]}),(0,r.BX)(ec,{children:[(0,r.tZ)(M.Z,{color:"accent",size:"large",onClick:()=>p.push(B.W.SIGNUP),children:(0,w.t)("NEW_USER")}),(0,r.tZ)(M.Z,{size:"large",onClick:()=>p.push(B.W.LOGIN),children:(0,w.t)("EXISTING_USER")}),(0,r.tZ)(es,{host:u})]}),(0,r.tZ)(eu,{children:(0,r.tZ)(eh,{children:c?(0,r.tZ)(a.m,{signUp:()=>s(!1),host:u}):(0,r.tZ)(l.M,{router:p,login:()=>s(!0),host:u})})})]})})}let er=e=>{let{onMaybeChangeHost:t,children:n}=e,[i,a]=(0,R.useState)(0),[l,o]=(0,R.useState)(!1);return(0,r.tZ)(ea,{onClick:e=>{!(!el()||e.target instanceof HTMLButtonElement)&&(l||(a(i+1),i+1==7&&(a(0),o(!0))))},children:(0,r.BX)(r.HY,{children:[(0,r.tZ)(v,{open:l,onClose:()=>{o(!1),t()}}),n]})})},ea=(0,H.ZP)("div")(j()),el=()=>{let e=new URL(window.location.origin).hostname;return!(e.endsWith(".ente.io")||e.endsWith(".ente.sh"))},eo=(0,H.ZP)("div")(Q()),ed=(0,H.ZP)("div")(q()),ec=(0,H.ZP)("div")(z()),es=e=>{let{host:t}=e;return(0,r.tZ)(V.Z,{pt:4,textAlign:"center",children:t&&(0,r.tZ)(D.Z,{variant:"mini",color:"text.faint",children:t})})},eu=(0,H.ZP)("div")(J()),eh=(0,H.ZP)("div")($()),ep=()=>(0,r.BX)(F.sj,{naturalSlideWidth:400,naturalSlideHeight:300,isIntrinsicHeight:!0,totalSlides:3,isPlaying:!0,children:[(0,r.BX)(F.iR,{children:[(0,r.BX)(F.Mi,{index:0,children:[(0,r.tZ)(ef,{src:"/images/onboarding-lock/1x.png",srcSet:"/images/onboarding-lock/2x.png 2x, /images/onboarding-lock/3x.png 3x"}),(0,r.tZ)(em,{children:(0,r.tZ)(K.cC,{i18nKey:"intro_slide_1_title"})}),(0,r.tZ)(eZ,{children:(0,w.t)("intro_slide_1")})]}),(0,r.tZ)(F.Mi,{index:1,children:(0,r.BX)(ex,{children:[(0,r.tZ)(ef,{src:"/images/onboarding-safe/1x.png",srcSet:"/images/onboarding-safe/2x.png 2x, /images/onboarding-safe/3x.png 3x"}),(0,r.tZ)(em,{children:(0,r.tZ)(K.cC,{i18nKey:"intro_slide_2_title"})}),(0,r.tZ)(eZ,{children:(0,w.t)("intro_slide_2")})]})}),(0,r.tZ)(F.Mi,{index:2,children:(0,r.BX)(ex,{children:[(0,r.tZ)(ef,{src:"/images/onboarding-sync/1x.png",srcSet:"/images/onboarding-sync/2x.png 2x, /images/onboarding-sync/3x.png 3x"}),(0,r.tZ)(em,{children:(0,r.tZ)(K.cC,{i18nKey:"intro_slide_3_title"})}),(0,r.tZ)(eZ,{children:(0,w.t)("intro_slide_3")})]})})]}),(0,r.tZ)(eg,{})]}),eZ=e=>(0,r.tZ)(D.Z,{color:"text.muted",mt:2,mb:3,...e}),em=e=>(0,r.tZ)(D.Z,{variant:"h3",mt:4,...e}),ef=(0,H.ZP)("img")(ee()),eg=(0,H.ZP)(F.I5)(et()),ex=(0,H.ZP)("div")(en())},18944:function(e,t,n){"use strict";n.d(t,{m:function(){return x}});var i=n(52903),r=n(10934),a=n(22063),l=n(63462),o=n(83446),d=n(50006),c=n(25683),s=n(84381),u=n(96566),h=n(42541),p=n(24991),Z=n(5632),m=n(50193),f=n(30433),g=n(34360);let x=e=>{let{signUp:t,host:n}=e,x=(0,Z.useRouter)(),_=async(e,t)=>{try{await (0,c.CA)({email:e});let t=await (0,m.O3)(e);r.ZP.debug(()=>["srpAttributes",JSON.stringify(t)]),!t||t.isEmailMFAEnabled?(await (0,f.Tb)(e),x.push(g.q.VERIFY)):((0,c.a_)(c.Pd.SRP_ATTRIBUTES,t),x.push(g.q.CREDENTIALS))}catch(e){t(e instanceof Error?"".concat((0,p.t)("UNKNOWN_ERROR")," (reason:").concat(e.message,")"):"".concat((0,p.t)("UNKNOWN_ERROR")," (reason:").concat(JSON.stringify(e),")"))}};return(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.Z,{children:(0,p.t)("login")}),(0,i.tZ)(d.Z,{callback:_,fieldType:"email",placeholder:(0,p.t)("ENTER_EMAIL"),buttonText:(0,p.t)("login"),autoComplete:"username",hiddenPostInput:(0,i.tZ)(s.Z,{sx:{display:"none"},type:"password",value:""})}),(0,i.tZ)(a.Z,{children:(0,i.BX)(u.Z,{gap:4,children:[(0,i.tZ)(o.Z,{onClick:t,children:(0,p.t)("NO_ACCOUNT")}),(0,i.tZ)(h.Z,{variant:"mini",color:"text.faint",minHeight:"32px",children:null!=n?n:""})]})})]})}},1885:function(e,t,n){"use strict";n.d(t,{M:function(){return U}});var i=n(52903),r=n(30433),a=n(49354),l=n(34360),o=n(39596),d=n(46170),c=n(10934),s=n(25683),u=n(91430),h=n(22063),p=n(63462),Z=n(39382),m=n(83446),f=n(43643),g=n(38045),x=n(29650),_=n(50267),E=n(97490),b=n(53793),w=n(58488),R=n(42541),y=n(36673),S=n(35999),C=n(53091),v=n(70341),T=n(71523),A=n(56840),O=n(72595),I=n(96566),P=n(31708),N=n(24991),B=n(2784),k=n(98614),L=n(48601);let U=e=>{let{router:t,login:n,host:U}=e,[W,X]=(0,B.useState)(!1),[M,H]=(0,B.useState)(!1),[V,D]=(0,B.useState)(!1),Y=()=>{D(!V)},F=e=>{e.preventDefault()},K=async(e,n)=>{let{email:i,passphrase:a,confirm:o,referral:u}=e,{setFieldError:h}=n;try{if(a!==o){h("confirm",(0,N.t)("PASSPHRASE_MATCH_ERROR"));return}H(!0);try{await (0,s.CA)({email:i}),(0,x.je)(u),await (0,r.Tb)(i)}catch(t){let e=t instanceof Error?t.message:"";throw h("confirm","".concat((0,N.t)("UNKNOWN_ERROR")," ").concat(e)),t}try{let{keyAttributes:e,masterKey:n,srpSetupAttributes:i}=await (0,d.j)(a);(0,s.a_)(s.Pd.ORIGINAL_KEY_ATTRIBUTES,e),(0,s.a_)(s.Pd.SRP_SETUP_ATTRIBUTES,i),await (0,g.iv)(a,e,n),await (0,g.CP)(_.Qm.ENCRYPTION_KEY,n),(0,x.n_)(!0),t.push(l.q.VERIFY)}catch(e){throw h("confirm",(0,N.t)("PASSWORD_GENERATION_FAILED")),e}}catch(e){c.ZP.error("signup failed",e)}H(!1)};return(0,i.BX)(i.HY,{children:[(0,i.BX)(p.Z,{children:[" ",(0,N.t)("sign_up")]}),(0,i.tZ)(P.J9,{initialValues:{email:"",passphrase:"",confirm:"",referral:""},validationSchema:L.Ry().shape({email:L.Z_().email((0,N.t)("EMAIL_ERROR")).required((0,N.t)("REQUIRED")),passphrase:L.Z_().required((0,N.t)("REQUIRED")),confirm:L.Z_().required((0,N.t)("REQUIRED"))}),validateOnChange:!1,validateOnBlur:!1,onSubmit:K,children:e=>{let{values:t,errors:n,handleChange:r,handleSubmit:l}=e;return(0,i.BX)("form",{noValidate:!0,onSubmit:l,children:[(0,i.BX)(u.wx,{sx:{mb:1},children:[(0,i.tZ)(b.Z,{fullWidth:!0,id:"email",name:"email",autoComplete:"username",type:"email",label:(0,N.t)("ENTER_EMAIL"),value:t.email,onChange:r("email"),error:!!n.email,helperText:n.email,autoFocus:!0,disabled:M}),(0,i.tZ)(b.Z,{fullWidth:!0,id:"password",name:"password",autoComplete:"new-password",type:V?"text":"password",label:(0,N.t)("PASSPHRASE_HINT"),value:t.passphrase,onChange:r("passphrase"),error:!!n.passphrase,helperText:n.passphrase,disabled:M,InputProps:{endAdornment:(0,i.tZ)(Z.Z,{showPassword:V,handleClickShowPassword:Y,handleMouseDownPassword:F})}}),(0,i.tZ)(b.Z,{fullWidth:!0,id:"confirm-password",name:"confirm-password",autoComplete:"new-password",type:"password",label:(0,N.t)("CONFIRM_PASSPHRASE"),value:t.confirm,onChange:r("confirm"),error:!!n.confirm,helperText:n.confirm,disabled:M}),(0,i.tZ)(a.L,{password:t.passphrase}),(0,i.BX)(w.Z,{sx:{width:"100%"},children:[(0,i.tZ)(R.Z,{textAlign:"left",color:"text.secondary",mt:"24px",children:(0,N.t)("REFERRAL_CODE_HINT")}),(0,i.tZ)(b.Z,{hiddenLabel:!0,InputProps:{endAdornment:(0,i.tZ)(y.Z,{position:"end",children:(0,i.tZ)(S.Z,{title:(0,N.t)("REFERRAL_INFO"),children:(0,i.tZ)(C.Z,{tabIndex:-1,color:"secondary",edge:"end",children:(0,i.tZ)(E.Z,{})})})})},fullWidth:!0,name:"referral",type:"text",value:t.referral,onChange:r("referral"),error:!!n.referral,disabled:M})]}),(0,i.tZ)(v.Z,{sx:{width:"100%"},children:(0,i.tZ)(T.Z,{sx:{color:"text.muted",ml:0,mt:2,mb:0},control:(0,i.tZ)(A.Z,{size:"small",disabled:M,checked:W,onChange:e=>X(e.target.checked),color:"accent"}),label:(0,i.tZ)(R.Z,{variant:"small",children:(0,i.tZ)(k.cC,{i18nKey:"TERMS_AND_CONDITIONS",components:{a:(0,i.tZ)(O.Z,{href:"https://ente.io/terms",target:"_blank"}),b:(0,i.tZ)(O.Z,{href:"https://ente.io/privacy",target:"_blank"})}})})})})]}),(0,i.BX)(w.Z,{mb:4,children:[(0,i.tZ)(f.Z,{sx:{my:0},buttonText:(0,N.t)("CREATE_ACCOUNT"),loading:M,disabled:!W||(0,o.DZ)(t.passphrase)}),M&&(0,i.tZ)(R.Z,{mt:1,textAlign:"center",color:"text.muted",variant:"small",children:(0,N.t)("KEY_GENERATION_IN_PROGRESS_MESSAGE")})]})]})}}),(0,i.tZ)(h.Z,{children:(0,i.BX)(I.Z,{gap:4,children:[(0,i.tZ)(m.Z,{onClick:n,children:(0,N.t)("ACCOUNT_EXISTS")}),(0,i.tZ)(R.Z,{variant:"mini",color:"text.faint",minHeight:"32px",children:null!=U?U:""})]})})]})}},52535:function(e,t,n){"use strict";n.d(t,{I:function(){return a},T:function(){return l}});var i=n(27149),r=n(84001);let a=()=>(0,i.Z)((0,r.Z)().breakpoints.down("sm")),l=()=>(0,i.Z)("(hover: none) and (pointer: coarse)",{noSsr:!0})},40651:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var i=n(52903),r=n(36236);let a=(0,n(2784).forwardRef)(function(e,t){return(0,i.tZ)(r.Z,{direction:"up",ref:t,...e})})},50006:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var i=n(52903),r=n(91430),a=n(39382),l=n(94848),o=n(10222),d=n(53793),c=n(31708),s=n(24991),u=n(2784),h=n(48601),p=n(43643);function Z(e){var t;let{submitButtonProps:n}=e,{sx:Z,...m}=null!=n?n:{},[f,g]=(0,u.useState)(!1),[x,_]=(0,u.useState)(!1),E=async(t,n)=>{let{setFieldError:i,resetForm:r}=n;g(!0),await e.callback(t.inputValue,e=>i("inputValue",e),r),g(!1)},b=()=>{_(!x)},w=e=>{e.preventDefault()},R=(0,u.useMemo)(()=>{switch(e.fieldType){case"text":case"password":return h.Ry().shape({inputValue:h.Z_().required((0,s.t)("REQUIRED"))});case"email":return h.Ry().shape({inputValue:h.Z_().email((0,s.t)("EMAIL_ERROR")).required((0,s.t)("REQUIRED"))})}},[e.fieldType]);return(0,i.tZ)(c.J9,{initialValues:{inputValue:null!==(t=e.initialValue)&&void 0!==t?t:""},onSubmit:E,validationSchema:R,validateOnChange:!1,validateOnBlur:!1,children:t=>{let{values:n,errors:c,handleChange:u,handleSubmit:h}=t;return(0,i.BX)("form",{noValidate:!0,onSubmit:h,children:[e.hiddenPreInput,(0,i.tZ)(d.Z,{hiddenLabel:e.hiddenLabel,variant:"filled",fullWidth:!0,type:x?"text":e.fieldType,id:e.fieldType,name:e.fieldType,...e.hiddenLabel?{placeholder:e.placeholder}:e.realPlaceholder?{placeholder:e.realPlaceholder,label:e.realLabel}:{label:e.placeholder},value:n.inputValue,onChange:u("inputValue"),error:!!c.inputValue,helperText:c.inputValue,disabled:f,autoFocus:!e.disableAutoFocus,autoComplete:e.autoComplete,InputProps:{autoComplete:e.disableAutoComplete||"password"===e.fieldType?"off":"on",endAdornment:"password"===e.fieldType&&(0,i.tZ)(a.Z,{showPassword:x,handleClickShowPassword:b,handleMouseDownPassword:w})}}),(0,i.tZ)(l.Z,{sx:{position:"relative",top:c.inputValue?"-22px":"0",float:"right",padding:"0 8px"},children:e.caption}),e.hiddenPostInput,(0,i.BX)(r.A0,{justifyContent:"flex-end",flexWrap:e.blockButton?"wrap-reverse":"nowrap",children:[e.secondaryButtonAction&&(0,i.tZ)(o.Z,{onClick:e.secondaryButtonAction,size:"large",color:"secondary",sx:{"&&&":{mt:e.blockButton?.5:2,mb:e.blockButton?0:4,mr:e.blockButton?0:1,...Z}},...m,children:(0,s.t)("cancel")}),(0,i.tZ)(p.Z,{sx:{"&&&":{mt:2,...Z}},buttonText:e.buttonText,loading:f,...m})]})]})}})}}},function(e){e.O(0,[1981,1708,4373,5999,3432,3692,805,4048,9049,2888,9774,179],function(){return e(e.s=87314)}),_N_E=e.O()}]);